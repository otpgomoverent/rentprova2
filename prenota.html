<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Prenota — Go Move Rent</title>
  <meta name="description" content="Prenotazione noleggio a Ercolano (NA).">
  <link rel="icon" href="assets/logo.png">
  <link rel="apple-touch-icon" href="assets/logo.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/style.css?v=1">
  <style>
/* --- Smart Tables (inline) --- */
.smart-table { width:100%; border-collapse: separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid rgba(10,16,32,.10); background:#fff; box-shadow: 0 10px 30px rgba(10,16,32,.08); }
.smart-table thead th { position: sticky; top:0; background:#f6f8fc; color:#1f2a44; text-align:left; font-weight:700; padding:10px; border-bottom:1px solid rgba(10,16,32,.10); cursor:pointer }
.smart-table tbody td { padding:10px; border-bottom:1px solid rgba(10,16,32,.10) }
.smart-table tfoot th { padding:10px; background:#f6f8fc; border-top:1px solid rgba(10,16,32,.10); text-align:right }
.smart-actions { display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 }
.smart-actions .btn { padding:8px 12px }
.zebra tbody tr:nth-child(odd) { background:#fbfdff }
.number { text-align:right }
.badge-ok { display:inline-block; padding:2px 8px; border-radius:999px; background:#e8fff4; color:#047857; border:1px solid #b6f0d2; font-weight:700; font-size:12px }
.badge-warn { display:inline-block; padding:2px 8px; border-radius:999px; background:#fff7ed; color:#b45309; border:1px solid #fed7aa; font-weight:700; font-size:12px }
</style>

  <!-- Smart Tables styles (inline) -->
  <style>
  .smart-table { width:100%; border-collapse: separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid rgba(10,16,32,.10); background:#fff; box-shadow: 0 10px 30px rgba(10,16,32,.08); }
  .smart-table thead th { position: sticky; top:0; background:#f6f8fc; color:#1f2a44; text-align:left; font-weight:700; padding:10px; border-bottom:1px solid rgba(10,16,32,.10); cursor:pointer }
  .smart-table tbody td { padding:10px; border-bottom:1px solid rgba(10,16,32,.10) }
  .smart-table tfoot th { padding:10px; background:#f6f8fc; border-top:1px solid rgba(10,16,32,.10); text-align:right }
  .smart-actions { display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 }
  .smart-actions .btn { padding:8px 12px }
  .zebra tbody tr:nth-child(odd) { background:#fbfdff }
  .number { text-align:right }
  .badge-ok { display:inline-block; padding:2px 8px; border-radius:999px; background:#e8fff4; color:#047857; border:1px solid #b6f0d2; font-weight:700; font-size:12px }
  .badge-warn { display:inline-block; padding:2px 8px; border-radius:999px; background:#fff7ed; color:#b45309; border:1px solid #fed7aa; font-weight:700; font-size:12px }
  </style>

</head>
  <a class="whatsapp-fab" href="https://wa.me/393451116918?text=Ciao%20Go%20Move%2C%20vorrei%20info%20per%20un%20noleggio" target="_blank" rel="noopener" aria-label="Chat WhatsApp">
  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20.5 3.5A10 10 0 0 0 3.2 17.2L2 22l4.9-1.3A10 10 0 1 0 20.5 3.5Zm-8.5 17a8.4 8.4 0 0 1-4.3-1.2l-.3-.2-2.9.8.8-2.8-.2-.3A8.5 8.5 0 1 1 12 20.5Zm4.9-6.3c-.3-.2-1.7-.9-2-.9s-.5.1-.7.4-.8.9-1 .9-.5 0-.9-.3a7.5 7.5 0 0 1-2.2-1.9c-.6-.7-1-1.6-1.1-1.8s0-.4.2-.6l.5-.7c.1-.2.2-.4.1-.6s-.6-1.6-.8-2.1-.4-.5-.6-.5h-.5a1 1 0 0 0-.7.4 3 3 0 0 0-1 2.2 5.2 5.2 0 0 0 1.1 2.7 12 12 0 0 0 4.6 4.4 5 5 0 0 0 2.6.8 2.3 2.3 0 0 0 1.6-.7 2 2 0 0 0 .5-1.3c0-.3 0-.5-.1-.6Z"/></svg>
</a>

<header>
  <div class="container nav">
    <a href="index.html" class="brand"><img src="assets/logo.png" alt="Go Move Rent logo" class="logo"/></a>
    <nav class="menu" id="menu" aria-label="Navigazione principale">
      <a data-active="index" href="index.html">Home</a>
      <a data-active="auto" href="auto.html">Auto</a>
      <a data-active="moto" href="moto.html">Scooter & Moto</a>
      <a data-active="preventivo" href="preventivo.html">Preventivo</a>
      <a data-active="prenota" href="prenota.html">Prenota</a>
    </nav>
    <button class="menu-toggle" id="menuToggle" aria-label="Apri menu" aria-expanded="false">☰</button>
  </div>
</header>

<main class="hero slim">
  <div class="container">
    <h1 class="title">Prenota ora</h1>
    <p class="muted" id="vehicleChosen"></p>
    <section class="grid" aria-labelledby="prenota-title">
      <div class="smart-card smart-pad">
        <h2 id="prenota-title" class="smart-title">Dettagli prenotazione</h2>
        <p class="smart-sub">Compila i campi e clicca “Verifica disponibilità”.</p>
        <table class="smart-table zebra" role="grid" aria-label="Dati prenotazione">
          <thead><tr><th style="width:28%">Campo</th><th>Valore</th><th class="number" style="width:20%">Note</th></tr></thead>
          <tbody>
            <tr><td>Luogo di ritiro</td><td><input id="pr-pickup-place" class="smart-input" placeholder="Ercolano (NA)"/></td><td class="number muted">Sede</td></tr>
            <tr><td>Luogo di riconsegna</td><td><input id="pr-drop-place" class="smart-input" placeholder="Ercolano (NA)"/></td><td class="number muted">Sede</td></tr>
            <tr><td>Data e ora ritiro</td><td><input id="pr-pickup" type="datetime-local" class="smart-input"/></td><td class="number muted">Obbligatorio</td></tr>
            <tr><td>Data e ora riconsegna</td><td><input id="pr-dropoff" type="datetime-local" class="smart-input"/></td><td class="number muted">Obbligatorio</td></tr>
            <tr><td>Categoria veicolo</td><td>
              <select id="pr-cat" class="smart-input">
                <option>City Car</option><option>Berlina</option><option>SUV</option><option>Scooter</option><option>Moto</option>
              </select>
            </td><td class="number"><span class="badge badge-ok">Disponibile</span></td></tr>
            <tr><td>Età conducente</td><td><input id="pr-age" type="number" min="18" max="90" value="30" class="smart-input"/></td><td class="number muted">Min 18</td></tr>
            <tr><td>Extra</td><td>
              <div class="inline">
                <label><input class="pr-extra" data-price="5" type="checkbox"> Navigatore</label>
                <label><input class="pr-extra" data-price="4" type="checkbox"> Seggiolino</label>
                <label><input class="pr-extra" data-price="7" type="checkbox"> Guidatore aggiuntivo</label>
                <label><input class="pr-extra" data-price="15" type="checkbox"> Kasko totale</label>
              </div>
            </td><td class="number muted">€/giorno</td></tr>
            <tr><td>Dati cliente</td><td>
              <div class="inline" style="width:100%">
                <input id="pr-name" class="smart-input" placeholder="Nome e Cognome" style="flex:1 1 220px">
                <input id="pr-mail" type="email" class="smart-input" placeholder="Email" style="flex:1 1 220px">
                <input id="pr-phone" class="smart-input" placeholder="Telefono" style="flex:1 1 160px">
              </div>
            </td><td class="number muted">Per conferma</td></tr>
          </tbody>
        </table>
        <div class="smart-actions">
          <button class="btn btn-primary" onclick="checkAvailability()">Verifica disponibilità</button>
          <button class="btn btn-ghost" onclick="resetPrenota()">Reset</button>
        </div>
<div id="prResult" class="mt-2" aria-live="polite"></div>
      </div>
      <aside class="smart-card smart-pad sticky" aria-live="polite">
        <h3 class="smart-title">Disponibilità</h3>
        <p class="smart-sub">Risultato immediato con stima di costo.</p>
        <table class="smart-table" aria-label="Esito verifica">
          <thead><tr><th>Elemento</th><th class="number">Valore</th></tr></thead>
          <tbody id="pr-result-rows">
            <tr><td>Stato</td><td class="number"><span class="badge badge-warn">In attesa</span></td></tr>
            <tr><td>Giorni</td><td id="pr-days" class="number">—</td></tr>
            <tr><td>Totale stimato</td><td id="pr-total" class="number price-xs">—</td></tr>
          </tbody>
        </table>
        <div class="smart-actions">
          <button class="btn btn-primary btn-block" onclick="sendBooking()">Invia prenotazione</button>
        </div>
      </aside>
    </section>
  </div>
</main>
  <!-- Riepilogo smart -->
<div id="bookingSummary"></div>
</div></section>

<footer>
  <div class="container footer-grid">
    <div>
      <img src="assets/logo.png" alt="Go Move Rent logo" class="logo footer-logo"/>
      <p class="muted">Ritiro e riconsegna: <b>Ercolano (NA)</b>.<br/>Assistenza 7/7.</p>
    </div>
    <div>
      <h4>Servizi</h4>
      <ul>
        <li><a href="auto.html">Noleggio auto</a></li>
        <li><a href="moto.html">Scooter & Moto</a></li>
        <li><a href="preventivo.html">Preventivo</a></li>
        <li><a href="prenota.html">Prenota</a></li>
      </ul>
    </div>
    <div>
      <h4>Contatti</h4>
      <ul>
        <li><a href="tel:+393451116918">+39 3451116918</a></li>
        <li><a href="tel:+3908118385287">+39 08118385287</a></li>
        <li><a href="mailto:gomoverent@gmail.com">gomoverent@gmail.com</a></li>
        <li>Ci troviamo ad Ercolano (NA) in Via Trentola 156</li>
      </ul>
    </div>
  </div>
  <div class="container foot-note">
    © <span id="year"></span> Go Move s.r.l. — P.IVA 00994550945 • <a href="#top">Torna su ↑</a>
  </div>
</footer>
</script>

  <!-- Smart Tables script (inline) -->
  <script>
  function euro(n){ try { return (n||0).toLocaleString('it-IT',{style:'currency',currency:'EUR'});}catch(e){return n} }
  function smartSortTable(table, colIndex, numeric=false){
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.querySelectorAll('tr'));
    const dir = table.getAttribute('data-sortdir') === 'asc' ? 'desc' : 'asc';
    rows.sort((a,b)=>{
      const ta = a.children[colIndex].innerText.trim();
      const tb = b.children[colIndex].innerText.trim();
      if(numeric){
        const na = parseFloat(ta.replace(/[€\s\.]/g,'').replace(',', '.')) || 0;
        const nb = parseFloat(tb.replace(/[€\s\.]/g,'').replace(',', '.')) || 0;
        return dir==='asc' ? na-nb : nb-na;
      } else {
        return dir==='asc' ? ta.localeCompare(tb) : tb.localeCompare(ta);
      }
    });
    rows.forEach(r=>tbody.appendChild(r));
    table.setAttribute('data-sortdir', dir);
  }
  function tableToCSV(table){
    const rows = table.querySelectorAll('tr');
    return Array.from(rows).map(tr => Array.from(tr.children).map(td => `"$\{td.innerText.replace(/"/g,'""')\}"`).join(',')).join('\n');
  }
  function copySmartTable(tableId){
    const table = document.getElementById(tableId);
    const csv = tableToCSV(table);
    navigator.clipboard.writeText(csv).then(()=>alert('Tabella copiata (CSV negli appunti).'));
  }
  function downloadSmartTable(tableId, filename='tabella.csv'){
    const table = document.getElementById(tableId);
    const csv = tableToCSV(table);
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = filename; a.click();
    URL.revokeObjectURL(url);
  }
  function renderQuoteSmart(result){
    const box = document.getElementById('quoteResult');
    if(!box) return;
    const rows = (result.items||[]).map(i=>`<tr><td>$\{i.voce||''\}</td><td class="number">$\{euro(i.importo||0)\}</td></tr>`).join('');
    box.innerHTML = `
      <div class="smart-actions">
        <button class="btn" onclick="copySmartTable('tblQuote')">Copia (CSV)</button>
        <button class="btn" onclick="downloadSmartTable('tblQuote','preventivo.csv')">Scarica CSV</button>
      </div>
      <table class="smart-table zebra" id="tblQuote" data-sortdir="asc">
        <thead>
          <tr>
            <th onclick="smartSortTable(this.closest('table'),0,false)">Voce</th>
            <th onclick="smartSortTable(this.closest('table'),1,true)">Importo</th>
          </tr>
        </thead>
        <tbody>$\{rows\}</tbody>
        <tfoot>
          <tr><th>Imponibile</th><th class="number">$\{euro(result.imponibile||0)\}</th></tr>
          <tr><th>IVA (22%)</th><th class="number">$\{euro(result.iva||0)\}</th></tr>
          <tr><th style="font-size:18px">Totale</th><th class="number" style="font-size:18px">$\{euro(result.totale||0)\}</th></tr>
        </tfoot>
      </table>`;
  }
  function renderBookingSmart(summary){
    const box = document.getElementById('bookingSummary');
    if(!box) return;
    const rows = (summary.rows||[]).map(r=>`<tr><td>$\{r.k\}</td><td class="number">$\{r.v\}</td></tr>`).join('');
    box.innerHTML = `
      <div class="smart-actions">
        <span class="$\{summary.ok ? 'badge-ok':'badge-warn'\}">$\{summary.ok ? 'Disponibilità trovata' : 'Non disponibile'\}</span>
        <button class="btn" onclick="copySmartTable('tblBooking')">Copia (CSV)</button>
        <button class="btn" onclick="downloadSmartTable('tblBooking','prenotazione.csv')">Scarica CSV</button>
      </div>
      <table class="smart-table zebra" id="tblBooking" data-sortdir="asc">
        <thead>
          <tr><th onclick="smartSortTable(this.closest('table'),0,false)">Voce</th><th onclick="smartSortTable(this.closest('table'),1,true)">Valore</th></tr>
        </thead>
        <tbody>$\{rows\}</tbody>
        <tfoot>
          <tr><th>Totale</th><th class="number">$\{euro(summary.totale||0)\}</th></tr>
        </tfoot>
      </table>`;
  }
  (function(){
    if(typeof handlePreventivo === 'function'){
      const _h = handlePreventivo;
      window.handlePreventivo = function(e){
        e && e.preventDefault && e.preventDefault();
        _h.apply(this, arguments);
        if(window._lastQuote){ renderQuoteSmart(window._lastQuote); }
      };
    }
    if(typeof handleBooking === 'function'){
      const _b = handleBooking;
      window.handleBooking = function(e){
        e && e.preventDefault && e.preventDefault();
        try{ _b.apply(this, arguments);}catch(err){}
        try{
          const form = (e && e.target) || document.querySelector('#bookingForm');
          const start = new Date(form?.start?.value), end = new Date(form?.end?.value);
          const hours = Math.ceil((end-start)/36e5);
          const days = Math.max(1, Math.ceil(hours/24));
          const age = Number(form?.age?.value || 0);
          const category = form?.category?.value || '';
          let daily = (typeof basePriceFor==='function') ? basePriceFor(category) : 50;
          if (age && age < 25) daily += 12;
          let totale = daily * days;
          if (document.getElementById('opt_gps')?.checked) totale += 5 * days;
          if (document.getElementById('opt_seat')?.checked) totale += 4 * days;
          if (document.getElementById('opt_add')?.checked)  totale += 6 * days;
          if (document.getElementById('opt_kasko')?.checked) totale += 15 * days;
          const summary = {
            ok:true, totale,
            rows: [
              {k:'Categoria', v: category},
              {k:'Giorni', v: String(days)},
              {k:'Età conducente', v: String(age||'')},
              {k:'Navigatore', v: document.getElementById('opt_gps')?.checked ? 'Sì':'No'},
              {k:'Seggiolino bimbo', v: document.getElementById('opt_seat')?.checked ? 'Sì':'No'},
              {k:'Guidatore aggiuntivo', v: document.getElementById('opt_add')?.checked ? 'Sì':'No'},
              {k:'Kasko totale', v: document.getElementById('opt_kasko')?.checked ? 'Sì':'No'}
            ]
          };
          renderBookingSmart(summary);
        }catch(err){}
      };
    }
  })();
  <script src="assets/script.js"></script>
</body>
</body>
</html>
